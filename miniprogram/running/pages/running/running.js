"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var app = getApp();
var host1_1 = require("./host1");
var host2_1 = require("./host2");
var host3_1 = require("./host3");
var host4_1 = require("./host4");
var host5_1 = require("./host5");
var host6_1 = require("./host6");
var host7_1 = require("./host7");
var host8_1 = require("./host8");
var host9_1 = require("./host9");
var HOSTS = [
    host1_1.HOST_1, host2_1.HOST_2, host3_1.HOST_3, host4_1.HOST_4,
    host5_1.HOST_5, host6_1.HOST_6, host7_1.HOST_7, host8_1.HOST_8,
    host9_1.HOST_9
];
Page({
    onShow: function () {
        app.sound("start");
        this.setData({
            bgmPlaying: !app.bgmPaused()
        });
    },
    toggleBGM: function () {
        this.setData({
            bgmPlaying: !this.data.bgmPlaying
        });
        app.toggleBGM();
    },
    data: {
        sid: '',
        pid: '',
        questionNumber: 0,
        questionContent: "",
        choiceA: "",
        choiceB: "",
        lastChoice: '',
        lastChoiceStatus: 'unknown',
        LOTTERY_CORRECT_COUNT: 3,
        HOST_SRC: '',
        bgmPlaying: true
    },
    nextQuestionPending: false,
    nextQuestion: function (evt) {
        if (this.nextQuestionPending) {
            return;
        }
        var choice = evt.currentTarget.id;
        var page = this;
        this.nextQuestionPending = true;
        this.setData({ lastChoice: choice });
        wx.request({
            method: "POST",
            url: app.API_ENDPOINT + ("/session/" + this.data.sid + "/problem/" + this.data.pid),
            data: {
                ans: choice
            },
            header: {
                'X-User-Token': app.globalData.token
            },
            success: app.handleRequstFinish(function (res) {
                var session = res.data;
                if (session.status == 'done') {
                    app.sound("failed");
                    page.setData({ lastChoiceStatus: 'error' });
                    setTimeout(function () {
                        page.nextQuestionPending = false;
                        if (session.correct_count >= page.data.LOTTERY_CORRECT_COUNT) {
                            wx.redirectTo({
                                url: "/info-pages/pages/success/success?correct_count=" + session.correct_count + "&session_id=" + session.id,
                            });
                        }
                        else {
                            wx.redirectTo({
                                url: '/info-pages/pages/failure/failure'
                            });
                        }
                    }, 500);
                }
                else {
                    app.sound("correct");
                    page.setData({ lastChoiceStatus: 'correct' });
                    setTimeout(function () {
                        page.nextQuestionPending = false;
                        page.setData({
                            pid: session.problem.id,
                            questionContent: session.problem.body,
                            questionNumber: session.problem.idx,
                            choiceA: session.problem.A,
                            choiceB: session.problem.B,
                            lastChoiceStatus: 'unknown'
                        });
                    }, 500);
                }
            }),
            fail: function (res) {
                page.nextQuestionPending = false;
                app.handleRequestFail(res);
            }
        });
    },
    onLoad: function () {
        this.setData({
            HOST_SRC: "data:image/png;base64," + HOSTS[Math.floor(Math.random() * 9)]
        });
        var self = this;
        wx.request({
            url: app.API_ENDPOINT + "/session",
            method: "POST",
            header: {
                'X-User-Token': app.globalData.token
            },
            success: app.handleRequstFinish(function (res) {
                var session = res.data;
                self.setData({
                    sid: session.id,
                    pid: session.problem.id,
                    questionContent: session.problem.body,
                    questionNumber: session.problem.idx,
                    choiceA: session.problem.A,
                    choiceB: session.problem.B
                });
            }),
            fail: app.handleRequestFail
        });
    },
    onShareAppMessage: function () { return app.onShare(); }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnVubmluZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInJ1bm5pbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFJLEdBQUcsR0FBRyxNQUFNLEVBQWMsQ0FBQztBQUUvQixpQ0FBaUM7QUFDakMsaUNBQWlDO0FBQ2pDLGlDQUFpQztBQUNqQyxpQ0FBaUM7QUFDakMsaUNBQWlDO0FBQ2pDLGlDQUFpQztBQUNqQyxpQ0FBaUM7QUFDakMsaUNBQWlDO0FBQ2pDLGlDQUFpQztBQUVqQyxJQUFNLEtBQUssR0FBa0I7SUFDM0IsY0FBTSxFQUFFLGNBQU0sRUFBRSxjQUFNLEVBQUUsY0FBTTtJQUM5QixjQUFNLEVBQUUsY0FBTSxFQUFFLGNBQU0sRUFBRSxjQUFNO0lBQzlCLGNBQU07Q0FDUCxDQUFBO0FBRUQsSUFBSSxDQUFDO0lBQ0gsTUFBTTtRQUNKLEdBQUcsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDbkIsSUFBSSxDQUFDLE9BQU8sQ0FBQztZQUNYLFVBQVUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUU7U0FDN0IsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUNELFNBQVM7UUFDUCxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1gsVUFBVSxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVO1NBQ2xDLENBQUMsQ0FBQztRQUNILEdBQUcsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNsQixDQUFDO0lBQ0QsSUFBSSxFQUFFO1FBQ0osR0FBRyxFQUFFLEVBQUU7UUFDUCxHQUFHLEVBQUUsRUFBRTtRQUNQLGNBQWMsRUFBQyxDQUFDO1FBQ2hCLGVBQWUsRUFBQyxFQUFFO1FBQ2xCLE9BQU8sRUFBQyxFQUFFO1FBQ1YsT0FBTyxFQUFDLEVBQUU7UUFDVixVQUFVLEVBQUUsRUFBRTtRQUNkLGdCQUFnQixFQUFFLFNBQVM7UUFDM0IscUJBQXFCLEVBQUUsQ0FBQztRQUN4QixRQUFRLEVBQUUsRUFBRTtRQUNaLFVB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T1NUXzEgfSBmcm9tIFwiLi9ob3N0MVwiO1xuaW1wb3J0IHsgSE9TVF8yIH0gZnJvbSBcIi4vaG9zdDJcIjtcbmltcG9ydCB7IEhPU1RfMyB9IGZyb20gXCIuL2hvc3QzXCI7XG5pbXBvcnQgeyBIT1NUXzQgfSBmcm9tIFwiLi9ob3N0NFwiO1xuaW1wb3J0IHsgSE9TVF81IH0gZnJvbSBcIi4vaG9zdDVcIjtcbmltcG9ydCB7IEhPU1RfNiB9IGZyb20gXCIuL2hvc3Q2XCI7XG5pbXBvcnQgeyBIT1NUXzcgfSBmcm9tIFwiLi9ob3N0N1wiO1xuaW1wb3J0IHsgSE9TVF84IH0gZnJvbSBcIi4vaG9zdDhcIjtcbmltcG9ydCB7IEhPU1RfOSB9IGZyb20gXCIuL2hvc3Q5XCI7XG5cbmNvbnN0IEhPU1RTOiBBcnJheTxzdHJpbmc+ID0gW1xuICBIT1NUXzEsIEhPU1RfMiwgSE9TVF8zLCBIT1NUXzQsXG4gIEhPU1RfNSwgSE9TVF82LCBIT1NUXzcsIEhPU1RfOCxcbiAgSE9TVF85XG5dXG5cblBhZ2Uoe1xuICBvblNob3coKSB7XG4gICAgYXBwLnNvdW5kKFwic3RhcnRcIik7XG4gICAgdGhpcy5zZXREYXRhKHtcbiAgICAgIGJnbVBsYXlpbmc6ICFhcHAuYmdtUGF1c2VkKClcbiAgICB9KTtcbiAgfSxcbiAgdG9nZ2xlQkdNKCkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBiZ21QbGF5aW5nOiAhdGhpcy5kYXRhLmJnbVBsYXlpbmdcbiAgICB9KTtcbiAgICBhcHAudG9nZ2xlQkdNKCk7XG4gIH0sXG4gIGRhdGE6IHtcbiAgICBzaWQ6ICcnLFxuICAgIHBpZDogJycsXG4gICAgcXVlc3Rpb25OdW1iZXI6MCxcbiAgICBxdWVzdGlvbkNvbnRlbnQ6XCJcIixcbiAgICBjaG9pY2VBOlwiXCIsXG4gICAgY2hvaWNlQjpcIlwiLFxuICAgIGxhc3RDaG9pY2U6ICcnLFxuICAgIGxhc3RDaG9pY2VTdGF0dXM6ICd1bmtub3duJyxcbiAgICBMT1RURVJZX0NPUlJFQ1RfQ09VTlQ6IDMsXG4gICAgSE9TVF9TUkM6ICcnLFxuICAgIGJnbVBsYXlpbmc6IHRydWVcbiAgfSxcbiAgbmV4dFF1ZXN0aW9uUGVuZGluZzogZmFsc2UsXG4gIG5leHRRdWVzdGlvbjogZnVuY3Rpb24gKGV2dDogYW55KSB7XG4gICAgaWYgKHRoaXMubmV4dFF1ZXN0aW9uUGVuZGluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBjaG9pY2UgPSBldnQuY3VycmVudFRhcmdldC5pZDtcbiAgICB2YXIgcGFnZSA9IHRoaXM7XG4gICAgdGhpcy5uZXh0UXVlc3Rpb25QZW5kaW5nID0gdHJ1ZTtcbiAgICB0aGlzLnNldERhdGEoeyBsYXN0Q2hvaWNlOiBjaG9pY2UgfSk7XG4gICAgd3gucmVxdWVzdCh7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIHVybDogYXBwLkFQSV9FTkRQT0lOVCArIChcIi9zZXNzaW9uL1wiICsgdGhpcy5kYXRhLnNpZCArIFwiL3Byb2JsZW0vXCIgKyB0aGlzLmRhdGEucGlkKSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgYW5zOiBjaG9pY2VcbiAgICAgICAgfSxcbiAgICAgICAgaGVhZGVyOiB7XG4gICAgICAgICAgICAnWC1Vc2VyLVRva2VuJzogYXBwLmdsb2JhbERhdGEudG9rZW5cbiAgICAgICAgfSxcbiAgICAgICAgc3VjY2VzczogYXBwLmhhbmRsZVJlcXVzdEZpbmlzaChmdW5jdGlvbiAocmVzOiBhbnkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSByZXMuZGF0YTtcbiAgICAgICAgICAgIGlmIChzZXNzaW9uLnN0YXR1cyA9PSAnZG9uZScpIHtcbiAgICAgICAgICAgICAgYXBwLnNvdW5kKFwiZmFpbGVkXCIpXG4gICAgICAgICAgICAgICAgcGFnZS5zZXREYXRhKHsgbGFzdENob2ljZVN0YXR1czogJ2Vycm9yJyB9KTtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZS5uZXh0UXVlc3Rpb25QZW5kaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXNzaW9uLmNvcnJlY3RfY291bnQgPj0gcGFnZS5kYXRhLkxPVFRFUllfQ09SUkVDVF9DT1VOVCkge1xuICAgICAgICAgICAgICAgICAgICAgIHd4LnJlZGlyZWN0VG8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBgL2luZm8tcGFnZXMvcGFnZXMvc3VjY2Vzcy9zdWNjZXNzP2NvcnJlY3RfY291bnQ9JHtzZXNzaW9uLmNvcnJlY3RfY291bnR9JnNlc3Npb25faWQ9JHtzZXNzaW9uLmlkfWAsXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgd3gucmVkaXJlY3RUbyh7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvaW5mby1wYWdlcy9wYWdlcy9mYWlsdXJlL2ZhaWx1cmUnXG4gICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIGFwcC5zb3VuZChcImNvcnJlY3RcIilcbiAgICAgICAgICAgICAgICBwYWdlLnNldERhdGEoeyBsYXN0Q2hvaWNlU3RhdHVzOiAnY29ycmVjdCcgfSk7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2UubmV4dFF1ZXN0aW9uUGVuZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBwYWdlLnNldERhdGEoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGlkOiBzZXNzaW9uLnByb2JsZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVzdGlvbkNvbnRlbnQ6IHNlc3Npb24ucHJvYmxlbS5ib2R5LFxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25OdW1iZXI6IHNlc3Npb24ucHJvYmxlbS5pZHgsXG4gICAgICAgICAgICAgICAgICAgICAgICBjaG9pY2VBOiBzZXNzaW9uLnByb2JsZW0uQSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNob2ljZUI6IHNlc3Npb24ucHJvYmxlbS5CLFxuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdENob2ljZVN0YXR1czogJ3Vua25vd24nXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLFxuICAgICAgICBmYWlsOiBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICBwYWdlLm5leHRRdWVzdGlvblBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGFwcC5oYW5kbGVSZXF1ZXN0RmFpbChyZXMpO1xuICAgICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgb25Mb2FkKCkge1xuICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICBIT1NUX1NSQzogXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsXCIrIEhPU1RTW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDkpXVxuICAgIH0pO1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgIHd4LnJlcXVlc3Qoe1xuICAgICAgdXJsOiBhcHAuQVBJX0VORFBPSU5UICsgXCIvc2Vzc2lvblwiLFxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcjoge1xuICAgICAgICAnWC1Vc2VyLVRva2VuJzogYXBwLmdsb2JhbERhdGEudG9rZW5cbiAgICAgIH0sXG4gICAgICBzdWNjZXNzOiBhcHAuaGFuZGxlUmVxdXN0RmluaXNoKChyZXM6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCBzZXNzaW9uID0gcmVzLmRhdGE7XG4gICAgICAgIHNlbGYuc2V0RGF0YSh7XG4gICAgICAgICAgc2lkOiBzZXNzaW9uLmlkLFxuICAgICAgICAgIHBpZDogc2Vzc2lvbi5wcm9ibGVtLmlkLFxuICAgICAgICAgIHF1ZXN0aW9uQ29udGVudDogc2Vzc2lvbi5wcm9ibGVtLmJvZHksXG4gICAgICAgICAgcXVlc3Rpb25OdW1iZXI6IHNlc3Npb24ucHJvYmxlbS5pZHgsXG4gICAgICAgICAgY2hvaWNlQTogc2Vzc2lvbi5wcm9ibGVtLkEsXG4gICAgICAgICAgY2hvaWNlQjogc2Vzc2lvbi5wcm9ibGVtLkJcbiAgICAgICAgfSlcbiAgICAgIH0pLFxuICAgICAgZmFpbDogYXBwLmhhbmRsZVJlcXVlc3RGYWlsXG4gICAgfSlcbiAgfSxcbiAgb25TaGFyZUFwcE1lc3NhZ2U6IGZ1bmN0aW9uKCkgeyByZXR1cm4gYXBwLm9uU2hhcmUoKTsgfVxufSlcbiJdfQ==